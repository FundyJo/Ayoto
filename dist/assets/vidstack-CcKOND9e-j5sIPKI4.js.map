{"version":3,"file":"vidstack-CcKOND9e-j5sIPKI4.js","sources":["../../node_modules/@vidstack/react/prod/chunks/vidstack-CcKOND9e.js"],"sourcesContent":["\"use client\"\n\nimport { appendParamsToURL, IS_SERVER } from './vidstack-WyKbSRm0.js';\nimport { signal, listenEvent, effect, peek, isString } from './vidstack-CNjv_Zem.js';\n\nclass EmbedProvider {\n  #iframe;\n  src = signal(\"\");\n  /**\n   * Defines which referrer is sent when fetching the resource.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n   */\n  referrerPolicy = null;\n  get iframe() {\n    return this.#iframe;\n  }\n  constructor(iframe) {\n    this.#iframe = iframe;\n    iframe.setAttribute(\"frameBorder\", \"0\");\n    iframe.setAttribute(\"aria-hidden\", \"true\");\n    iframe.setAttribute(\n      \"allow\",\n      \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\"\n    );\n    if (this.referrerPolicy !== null) {\n      iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  setup() {\n    listenEvent(window, \"message\", this.#onWindowMessage.bind(this));\n    listenEvent(this.#iframe, \"load\", this.onLoad.bind(this));\n    effect(this.#watchSrc.bind(this));\n  }\n  #watchSrc() {\n    const src = this.src();\n    if (!src.length) {\n      this.#iframe.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.buildParams());\n    this.#iframe.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  postMessage(message, target) {\n    if (IS_SERVER) return;\n    this.#iframe.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  #onWindowMessage(event) {\n    const origin = this.getOrigin(), isOriginMatch = (event.source === null || event.source === this.#iframe?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch) return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message) this.onMessage(message, event);\n      return;\n    } catch (e) {\n    }\n    if (event.data) this.onMessage(event.data, event);\n  }\n}\n\nexport { EmbedProvider };\n"],"names":[],"mappings":";;;;;;;;;;;;;AAKA,MAAM,cAAc;AAAA,EAYlB,YAAY,QAAQ;AAZtB;AACE;AACA,+BAAM,OAAO,EAAE;AAMf;AAAA;AAAA;AAAA;AAAA;AAAA,0CAAiB;AAKf,uBAAK,SAAU;AACf,WAAO,aAAa,eAAe,GAAG;AACtC,WAAO,aAAa,eAAe,MAAM;AACzC,WAAO;AAAA,MACL;AAAA,MACA;AAAA,IACD;AACD,QAAI,KAAK,mBAAmB,MAAM;AAChC,aAAO,aAAa,kBAAkB,KAAK,cAAc;AAAA,IAC/D;AAAA,EACA;AAAA,EAdE,IAAI,SAAS;AACX,WAAO,mBAAK;AAAA,EAChB;AAAA,EAaE,QAAQ;AACN,gBAAY,QAAQ,WAAW,sBAAK,8CAAiB,KAAK,IAAI,CAAC;AAC/D,gBAAY,mBAAK,UAAS,QAAQ,KAAK,OAAO,KAAK,IAAI,CAAC;AACxD,WAAO,sBAAK,uCAAU,KAAK,IAAI,CAAC;AAAA,EACpC;AAAA,EAUE,YAAY,SAAS,QAAQ;;AAC3B,QAAI,UAAW;AACf,6BAAK,SAAQ,kBAAb,mBAA4B,YAAY,KAAK,UAAU,OAAO,GAAG,0BAAU;AAAA,EAC/E;AAYA;AApDE;AADF;AA6BE,cAAS,WAAG;AACV,QAAM,MAAM,KAAK,IAAK;AACtB,MAAI,CAAC,IAAI,QAAQ;AACf,uBAAK,SAAQ,aAAa,OAAO,EAAE;AACnC;AAAA,EACN;AACI,QAAM,SAAS,KAAK,MAAM,KAAK,YAAW,CAAE;AAC5C,qBAAK,SAAQ,aAAa,OAAO,kBAAkB,KAAK,MAAM,CAAC;AACnE;AAKE,qBAAgB,SAAC,OAAO;;AACtB,QAAM,SAAS,KAAK,UAAW,GAAE,iBAAiB,MAAM,WAAW,QAAQ,MAAM,aAAW,wBAAK,aAAL,mBAAc,oBAAmB,CAAC,SAAS,MAAM,KAAK,WAAW,MAAM;AACnK,MAAI,CAAC,cAAe;AACpB,MAAI;AACF,UAAM,UAAU,KAAK,MAAM,MAAM,IAAI;AACrC,QAAI,QAAS,MAAK,UAAU,SAAS,KAAK;AAC1C;AAAA,EACD,SAAQ,GAAG;AAAA,EAChB;AACI,MAAI,MAAM,KAAM,MAAK,UAAU,MAAM,MAAM,KAAK;AACpD;","x_google_ignoreList":[0]}